<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta http-equiv="X-UA-Compatible" content="ie=edge">
	<title>Document</title>
	<link rel="stylesheet" href="./../../../../../lib/font-awesome-4.7.0/css/font-awesome.css">
	<link rel="stylesheet" href="./../../../../../lib/element-ui/v2.4.1/theme-chalk/index.min.css">
	<link rel="stylesheet" href="./../../../../../src/css/main.css">
	<style>
        /*html,body,
		#app{
			width: 100%;
			height: 100%;
			background:transparent;
        }
        .content{
            color:#f0f8ff;
            padding: 10px;
        }*/
        html,body,
		#app {
			width: 100%;
			height: 100%;
			position: relative;
			overflow: hidden;
			background:transparent;
		}

		.content {
			height: calc(100% - 40px);
			overflow-y: auto;
			overflow-x: hidden;
		}

		.el-input-number,
		.el-cascader,
		.el-select {
			width: 100%;
		}
		.el-table, .el-table th, .el-table tr, .el-table td {
		    border: 0;
			background:transparent;
			
		}	
		.el-button--primary.is-plain, .el-button--default, .el-button--primary {
			color:#b5ddff;
			background: #0567ad78;
		}
		.el-input__inner, .el-textarea__inner {
		    height: 30px;
		    line-height: 30px;
		    border: 1px solid #466599;
		    color: #b5ddff;
		}
		.el-input, .el-input__inner, .el-textarea, .el-textarea__inner {
		    background: transparent;
		}
		.el-form-item__label {
			color:#fff;
		}
		.el-input-number--small .el-input-number__decrease, .el-input-number--small .el-input-number__increase {
		    background-color: transparent;
	        border-right: 1px solid #30538c;
	        border-left: 1px solid #30538c;
		}
        
	</style>
</head>

<body>
	<div id="app" v-cloak>
		<jas-dialog-wrapper>
			<el-form ref="tableFormData" :model="tableFormData" label-width="150px">
				<div style="margin: 0px 0px 6px; line-height: 32px; padding-top: 10px; border-bottom: 1px solid rgba(16, 39, 65);">
					<span style="padding: 0px 4px; height: 22px; line-height: 22px; display: inline-block; color: #fff; border-left: 2px solid rgb(64, 158, 255);">基本信息</span>
				</div>
				<el-row :gutter="10">
					<el-col :xs="12" :sm="12" :md="8" :lg="6" :xl="6">
						<el-form-item label="构筑物编号" prop="buildingCode">
							<el-input v-model="tableFormData.buildingCode" clearable placeholder="请输入构筑物编号" size="small"></el-input>
						</el-form-item>
					</el-col>	
					<el-col :xs="12" :sm="12" :md="8" :lg="6" :xl="6">
						<el-form-item label="构筑物类型" prop="buildingType">
							<el-input v-model="tableFormData.buildingType" clearable placeholder="请输入构筑物类型" size="small"></el-input>
						</el-form-item>
					</el-col>		
				</el-row>
				<el-row>	
					<el-col :xs="12" :sm="12" :md="8" :lg="6" :xl="6">
						<el-form-item label="起始里程" prop="startMileage">
							<el-input-number v-model="tableFormData.startMileage" clearable placeholder="请输入起始里程" size="small" :precision="3" :step="1" :max="999999.999" :min="0"></el-input-number>
						</el-form-item>
					</el-col>	
					<el-col :xs="12" :sm="12" :md="8" :lg="6" :xl="6">
						<el-form-item label="终止里程" prop="endMileage">
							<el-input-number v-model="tableFormData.endMileage" clearable placeholder="请输入终止里程" size="small" :precision="3" :step="1" :max="999999.999" :min="0"></el-input-number>
						</el-form-item>
					</el-col>	
				</el-row>
				<el-row>	
					<el-col :xs="12" :sm="12" :md="8" :lg="6" :xl="6">
						<el-form-item label="水平距离" prop="horizontalDistance">
							<el-input-number v-model="tableFormData.horizontalDistance" clearable placeholder="请输入水平距离" size="small" :precision="3" :step="1" :max="999999.999" :min="0"></el-input-number>
						</el-form-item>
					</el-col>	
					<el-col :xs="12" :sm="12" :md="8" :lg="6" :xl="6">
						<el-form-item label="垂直距离" prop="verticalDistance">
							<el-input-number v-model="tableFormData.verticalDistance" clearable placeholder="请输入垂直距离" size="small" :precision="3" :step="1" :max="999999.999" :min="0"></el-input-number>
						</el-form-item>
					</el-col>	
				</el-row>
				<el-row>	
					<el-col :xs="12" :sm="12" :md="8" :lg="6" :xl="6">
						<el-form-item label="起始坐标x" prop="pointx">
							<el-input-number v-model="tableFormData.pointx" clearable placeholder="请输入起始坐标x" size="small" :precision="3" :step="1" :max="999999.999" :min="0"></el-input-number>
						</el-form-item>
					</el-col>	
					<el-col :xs="12" :sm="12" :md="8" :lg="6" :xl="6">
						<el-form-item label="起始坐标y" prop="pointy">
							<el-input-number v-model="tableFormData.pointy" clearable placeholder="请输入起始坐标y" size="small" :precision="3" :step="1" :max="999999.999" :min="0"></el-input-number>
						</el-form-item>
					</el-col>	
				</el-row>
				<el-row>	
					<el-col :xs="12" :sm="12" :md="8" :lg="6" :xl="6">
						<el-form-item label="建筑分布" prop="buildingDistribution">
							<el-select v-model="tableFormData.buildingDistribution" clearable placeholder="请选择">
							</el-select>
						</el-form-item>
					</el-col>	
					<el-col :xs="12" :sm="12" :md="8" :lg="6" :xl="6">
						<el-form-item label="户数" prop="households">
							<el-input-number v-model="tableFormData.households" clearable placeholder="请输入户数" size="small" :step="1" :max="999999" :min="0"></el-input-number>
						</el-form-item>
					</el-col>	
				</el-row>
				<el-row>	
					<el-col :xs="12" :sm="12" :md="8" :lg="6" :xl="6">
						<el-form-item label="人口" prop="population">
							<el-input-number v-model="tableFormData.population" clearable placeholder="请输入人口" size="small" :step="1" :max="999999" :min="0"></el-input-number>
						</el-form-item>
					</el-col>	
					<el-col :xs="12" :sm="12" :md="8" :lg="6" :xl="6">
						<el-form-item label="地址" prop="address">
							<el-input v-model="tableFormData.address" clearable placeholder="请输入地址" size="small" ></el-input>
						</el-form-item>
					</el-col>	
				</el-row>
				<div style="margin: 0px 0px 6px; line-height: 32px; padding-top: 10px; border-bottom: 1px solid rgba(16, 39, 65);">
					<span style="padding: 0px 4px; height: 22px; line-height: 22px; display: inline-block; color: #fff; border-left: 2px solid rgb(64, 158, 255);">其他信息</span>
				</div>
				<el-row>
					<el-col :xs="24" :sm="24" :md="8" :lg="6" :xl="6">
						<el-form-item label="备注" prop="remarks">
							<el-input type="textarea" :autosize="{ minRows: 3, maxRows: 6 }" :rows="2" size="small" v-model="tableFormData.remarks"></el-input>
						</el-form-item>
					</el-col>
				</el-row>
			</el-form>
			
			<!-- <el-form ref="formData" :model="form" label-width="150px">:
				<jas-base-group-title name="基础信息"></jas-base-group-title>
				<jas-form-items ref="mainForm" :form="form" :fields="fields" :fields-config="fieldsConfig"></jas-form-items>
				<jas-base-group-title name="其他信息"></jas-base-group-title>
				<el-row>
					<el-col :xs="24" :sm="24" :md="24" :lg="24" :xl="24">
						<jas-remarks :remarks="form.remarks" @changevalue="changevalue"></jas-remarks>
					</el-col>
				</el-row>
				<jas-base-group-title name="附件信息"></jas-base-group-title>
				<jas-file-upload :project-oid="form.projectOid" ref="upload" @success="uploadSuccess"></jas-file-upload>
			</el-form> -->
			<div slot="footer" class="dialog-footer" style="text-align: center;margin-top: 6px;">
				<el-button size="small" @click="cancel()">取 消</el-button>
				<el-button size="small" type="primary" @click="save()">确 定</el-button>
			</div>
		</jas-dialog-wrapper>
		
	</div>
</body>
<script src="./../../../../../lib/jquery/jquery-1.12.4.min.js"></script>
<script src="./../../../../../lib/vue/vue.js"></script>
<script src="./../../../../../lib/element-ui/v2.4.1/index.min.js"></script>

<!-- <script src="../components/onepage-components.js "></script> -->
<script src="./../../../../../common/components/jas-components.js"></script>
<script src="./../../../../../common/js/jas-tools.js"></script>

<script>

var changedFeatures = [];
var currentSource = 'pd_settlement';

var formFields= [
	'buildingCode',
	'buildingType',
	'startMileage',
	'endMileage',
	'horizontalDistance',
	'verticalDistance',
	'pointx',
	'pointy',
	'buildingDistribution',
	'households',
	'population',
	'address'
]
var fields= [
	{
		name:'构筑物编号',
		fiels:'buildingCode',
	},
	{
		name:'构筑物类型',
		fiels:'buildingType',
	},
	{
		name:'起始里程',
		fiels:'startMileage',
	},
	{
		name:'终止里程',
		fiels:'endMileage',
	},
	{
		name:'水平距离',
		fiels:'horizontalDistance',
	},
	{
		name:'垂直距离',
		fiels:'verticalDistance',
	},
	{
		name:'垂直距离',
		fiels:'verticalDistance',
	},
	{
		name:'起始坐标点x',
		fiels:'pointx',
	},
	{
		name:'起始坐标点y',
		fiels:'pointy',
	},
	{
		name:'建筑分布',
		fiels:'buildingDistribution',
	},
	{
		name:'户数',
		fiels:'households',
	},
	{
		name:'人口',
		fiels:'population',
	},
	{
		name:'地址',
		fiels:'address',
	}
]
var fieldConfigArr ={
	buildingCode:{
		name: '构筑物编号',
		type: 'input',
		isRequired: true
	},
	buildingType:{
		name: '构筑物类型',
		type: 'select',
		domainName: 'high_impact_level_domain',
      	isRequired: true
	},
	startMileage:{
		type: 'input',
		name: '起始里程',
		type: 'number',
		max: 999999.999,
		precision: 3,
		isRequired: true
	},
	endMileage:{
		type: 'input',
		name: '终止里程',
		type: 'number',
		max: 999999.999,
		precision: 3,
		isRequired: true
	},
	horizontalDistance:{
		type: 'input',
		name: '水平距离',
		type: 'number',
		max: 999999.999,
		precision: 3,
		isRequired: true
	},
	verticalDistance:{
		type: 'input',
		name: '垂直距离',
		type: 'number',
		max: 999999.999,
		precision: 3,
		isRequired: true
	},
	pointx: {
		name:'起始坐标x',
		type: 'number',
		max: 999999.999,
		precision: 3
	},
	pointy: {
		name:'起始坐标y',
		type: 'number',
		max: 999999.999,
		precision: 3
	},
	buildingDistribution:{
		name: '建筑分布',
		type: 'select',
		domainName: 'high_impact_level_domain'
	},
	households:{
		name: '户数',
		type: 'number',
		max: 999999.999,
		precision: 3
	},
	population:{
		name: '人口',
		type: 'number',
		max: 999999.999,
		precision: 3
	},
	address:{
		name: '地址',
		rules: [{
			min: '0',
			max: 36,
			message: "不能超过36个字"
		}]
	}
}
	var app = new Vue({
		el: "#app",
		data: function () {
			var that = this;
			return {
				featureAttr: {},
				fieldsConfig: fieldConfigArr,
				groupNames: ['基本信息'],
				form: {},
				mainForm: {},
				fields: fields,
				tableFormData: {
					'buildingCode': '',
					'buildingType': '',
					'startMileage':'',
					'endMileage':'',
					'horizontalDistance':'',
					'verticalDistance':'',
					'pointx':'',
					'pointy':'',
					'buildingDistribution':'',
					'households':'',
					'population':'',
					'address':'',
					'reamrks':''
				},
				rules: {
						buildingCode:{
						name: '构筑物编号',
						type: 'input',
						isRequired: true
					},
					buildingType:{
						name: '构筑物类型',
						type: 'select',
						domainName: 'high_impact_level_domain',
						isRequired: true
					},
					startMileage:{
						type: 'input',
						name: '起始里程',
						type: 'number',
						max: 999999.999,
						precision: 3,
						isRequired: true
					},
					endMileage:{
						type: 'input',
						name: '终止里程',
						type: 'number',
						max: 999999.999,
						precision: 3,
						isRequired: true
					},
					horizontalDistance:{
						type: 'input',
						name: '水平距离',
						type: 'number',
						max: 999999.999,
						precision: 3,
						isRequired: true
					},
					verticalDistance:{
						type: 'input',
						name: '垂直距离',
						type: 'number',
						max: 999999.999,
						precision: 3,
						isRequired: true
					},
					pointx: {
						name:'起始坐标x',
						type: 'number',
						max: 999999.999,
						precision: 3
					},
					pointy: {
						name:'起始坐标y',
						type: 'number',
						max: 999999.999,
						precision: 3
					},
					buildingDistribution:{
						name: '建筑分布',
						type: 'select',
						domainName: 'high_impact_level_domain'
					},
					households:{
						name: '户数',
						type: 'number',
						max: 999999.999,
						precision: 3
					},
					population:{
						name: '人口',
						type: 'number',
						max: 999999.999,
						precision: 3
					},
					address:{
						name: '地址',
						rules: [{
							min: '0',
							max: 36,
							message: "不能超过36个字"
						}]
					}
				}
			}
		},
		created: function () {
            var that = this;
			this.initAttrTable();
			//this.fields = that.formatFields(formFields, fieldConfigArr);
			this.form = that.formatForm(fields);
			this.mainForm = that.formatForm(fields);
		},
		mounted: function(){
			//if (param.oid) {
				//this.oid = param.oid;
				//this.form.oid = this.oid;
				//this.isEdit = true;
				// this.getDetailByObjectId();
				// this.$refs.upload.requestFile(this.oid);
			//};
			var param = window.jasTools.base.getParamsInUrl(location.href);
			if (param.oid) {
				this.isEdit = true;
				this.oid = param.oid;
				this.tableFormData.oid = this.oid;
				this.requestDetail(param.oid);
			}
		},
		methods: {
			changevalue: function (msg) {
				this.form.remarks = msg;
			},
			formatFields: function (fields, fieldsConfig, templateCode) {
				return fields.map(function (item) {
					if (!fieldsConfig[item]) return {};
					var nameConfig = fieldsConfig[item].nameConfig;
					return {
					name: fieldsConfig[item].name,
					field: item,
					formatter: fieldsConfig[item].formatter,
					};
				});
			},
			formatForm: function (fields) {
				var obj = {};
				fields.forEach(function (item) {
					obj[item] = '';
				});
				obj.remarks = '';
				return obj;
			},
            cancel: function(){
                top.jasTools.selfDialog.close();
            },
			initAttrTable : function(){
				/* var table =  $("table.grid");
				$("input.attr-ipt" ,table).change();
				table.empty();

				table.append("<tbody></tbody>");

				var tbody = $("tbody", table);

				for (var i = 0; i < fields.length; i++) {
					if(i % 2 === 0 ){
						tbody.append("<tr></tr>") ;
					}
					var tr = $("tr",tbody).last();
					var item = fields[i];
					var td_title = "<td class='td-title'><label>" + item.title + "</label></td>";
					var td_ipt = "<td><input style='width:100px' v-model='featureAttr." +item.field+ "' class='attr-ipt' type='text' id='" + item.field +"'></td>";
					if(item.field == 'oid' && !(this.featureAttr.oid)){
						var uuid = this.jasMap.commonUtil.uuid();
						td_ipt = "<td><input style='width:100px' class='attr-ipt' type='text' id='oid' value='" + uuid +"'></td>";
					}
					
					tr.append(td_title);
					tr.append(td_ipt);
				} */
			},
			save: function () {
				var that = this;
				var msg = "";
				if (!this.isEdit) {
					msg = "增加成功";
					url = jasTools.base.rootPath +
						"/jdbc/commonData/hcabuildings/save.do";
				} else {
					msg = "修改成功";
					url = jasTools.base.rootPath +
						"/jdbc/commonData/hcabuildings/update.do";
				}
				that.but_disabled = true;
				/* jasTools.ajax.post(url, that.formData, function (data) {
					that.$refs.upload.uploadFile(data.data || that.oid);
				},function(data){
					if(data.status==-1){
						that.but_disabled = false;
					}
				}); */
				jasTools.ajax.post(url, that.tableFormData, function (data) {
					top.Vue.prototype.$message({
						type: 'success',
						message: msg
					});
					that.cancel(1);
				},function(data){
					if(data.status!=-1){
						that.but_disabled = false;
					}
				});
			},
		},
	});
</script>

</html>